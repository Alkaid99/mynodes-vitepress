# Mysql基本操作-DML

DML（数据操作语言）是用于处理数据操作的一组命令：

|常用命令|简介|
|-|-|
|`INSERT`|用于将数据插入表中。|
|`UPDATE`|用于更新表中的数据。|
|`DELETE`|用于从表中删除数据。|

## 插入数据

`INSERT`语句用于向表中插入新的数据行。

**基本语法：**

按指定的列插入数据：

```sql
INSERT INTO <表名> (column1,column2,column3,...)
VALUES (value1,value2,value3,...);
```

为所有列插入数据：

```sql
INSERT INTO <表名> VALUES (value1,value2,value3,...);
```

|选项|含义|
|-|-|
|`column`|表示要插入数据的列名|
|`value`|表示每列对应的值|

- 当为表中所有列添加数据时，可以不在 SQL 语句中指明列的名称，但是，请确保插入的值的顺序和表中各列的顺序相同。

在 MySQL 中数据库中的一种特殊语法，它允许在插入新记录时使用 SET 关键字来指定列的值：

```sql
INSERT INTO <表名> SET column1=value1, column2=value2, ... 
```

这语法在功能上是等效的，都可以用来向表中插入新记录。

它们之间的主要区别在于语法结构。使用`VALUES`关键字时，需要**按照表中列的顺序**依次指定每个列的值。而使用`SET`关键字时，您可以**直接指定每个列的名称和值，不需要考虑顺序**。

另外，`INSERT INTO <表名>  SET`语法仅适用于 MySQL 数据库，而`INSERT INTO <表名> (column1, column2, column3, ...) VALUES (value1, value2, value3, ...)`语法则被大多数数据库系统所支持。

**参考示例：**

1. 向 student 表中插入指定数据

    ```sql
    INSERT INTO student(sid, name, age, gender)
    VALUES('1', '张三', '18', '男');
    ```

2. 插入所有数据

    ```sql
    INSERT INTO student VALUES('2','李四','19','男','2004-01-01','上海');
    ```

3. 再插入一行数据，并不指定`sid`

    ```sql
    INSERT INTO student(name,age,gender) VALUES('王五','20','男');
    ```

    由于之前再创建表的时候在`sid`列指定了`AUTO_INCREMENT`关键字，所以不需要指定其`sid`，它会自动递增。

4. 一次性插入多行

    ```sql
    INSERT INTO student(name,age,gender) VALUES('赵六','21','男'),('小明','1','不知道');
    ```

5. 再插入多行数据

    ```sql
    INSERT INTO student VALUES('6','小红','18','女','2005-11-11','北京');
    INSERT INTO student VALUES('7','小蓝','17','女','2006-03-03','上海');
    INSERT INTO student(sid,name,age,gender,address) VALUES('8','小绿','15','女','广州');
    INSERT INTO student VALUES('9','小粉','18','不知道','2005-12-12','广州');
    ```

## 查看数据

`SELECT`语句用于从表中选取符合条件的数据，该数据以临时表的形式返回，称为结果**集**。

注意，`SELECT`不是DML语句！而是属于DQL语句，这里只是进行介绍，方便插入数据后进行查看。

**基本语法：**

```sql
SELECT <column1>, <column2>, <columnN>
FROM <表名>
[ WHERE <条件表达式> ]
```

**参考示例：**

注意，在查看数据之前需要进入该表中。

1. 查看表中所有数据

    如果想选取所有的列，那么可以使用`*`代替所有列名

    ```sql
    SELECT * FROM student;
    ```

    ```sql
    +-----+--------+-----+-----------+------------+---------+
    | sid | name   | age | gender    | birthday   | address |
    +-----+--------+-----+-----------+------------+---------+
    |   1 | 张三   |  18 | 男        | NULL       | NULL    |
    |   2 | 李四   |  19 | 男        | 2004-01-01 | 上海    |
    |   3 | 王五   |  20 | 男        | NULL       | NULL    |
    |   4 | 赵六   |  21 | 男        | NULL       | NULL    |
    |   5 | 小明   |   1 | 不知道    | NULL       | NULL    |
    |   6 | 小红   |  18 | 女        | 2005-11-11 | 北京    |
    |   7 | 小蓝   |  17 | 女        | 2006-03-03 | 上海    |
    |   8 | 小绿   |  15 | 女        | NULL       | 广州    |
    |   9 | 小粉   |  18 | 不知道    | 2005-12-12 | 广州    |
    +-----+--------+-----+-----------+------------+---------+
    ```

2. 选择指定的列查看

    ```sql
    SELECT name,age FROM student;
    ```

    ```sql
    +--------+-----+
    | name   | age |
    +--------+-----+
    | 张三   |  18 |
    | 李四   |  19 |
    | 王五   |  20 |
    | 赵六   |  21 |
    | 小明   |   1 |
    | 小红   |  18 |
    | 小蓝   |  17 |
    | 小绿   |  15 |
    | 小粉   |  18 |
    +--------+-----+
    ```

## 修改数据

`UPDATE`语句用于修改数据表中现有的记录（数据行）。`UPDATE`通常和`WHERE`子句一起使用，用以筛选满足条件的记录；如果不使用`WHERE`子句，那么表中所有的记录都将被修改，这往往不是我们期望的。

**基本语法：**

```sql
UPDATE <表名>
SET column1 = value1, column2 = value2, ...
WHERE condition;
```

|选项|含义|
|-|-|
|`column`|要修改的列。|
|`value`|要修改的值。|
|`condition`|修改条件。|

**参考示例：**

1. 将学生的地址改为上海

    ```sql
    UPDATE student SET address = '上海';
    SELECT * FROM student;
    ```

    ```sql
    +-----+--------+-----+-----------+------------+---------+
    | sid | name   | age | gender    | birthday   | address |
    +-----+--------+-----+-----------+------------+---------+
    |   1 | 张三   |  18 | 男        | NULL       | 上海    |
    |   2 | 李四   |  19 | 男        | 2004-01-01 | 上海    |
    |   3 | 王五   |  20 | 男        | NULL       | 上海    |
    |   4 | 赵六   |  21 | 男        | NULL       | 上海    |
    |   5 | 小明   |   1 | 不知道    | NULL       | 上海    |
    |   6 | 小红   |  18 | 女        | 2005-11-11 | 上海    |
    |   7 | 小蓝   |  17 | 女        | 2006-03-03 | 上海    |
    |   8 | 小绿   |  15 | 女        | NULL       | 上海    |
    |   9 | 小粉   |  18 | 不知道    | 2005-12-12 | 上海    |
    +-----+--------+-----+-----------+------------+---------+
    ```

    注意`UPDATE`语句中的`WHERE`子句！`WHERE`子句规定哪条记录或者哪些记录需要更新。如果省略了`WHERE`子句，所有的记录都将被更新！

2. 将部分学生地址改为背景

    ```sql
    UPDATE student SET address = '北京' WHERE name in ('小红','小蓝','小绿，'小粉');
    SELECT * FROM student;
    ```

    ```sql
    +-----+--------+-----+-----------+------------+---------+
    | sid | name   | age | gender    | birthday   | address |
    +-----+--------+-----+-----------+------------+---------+
    |   1 | 张三   |  18 | 男        | NULL       | 上海    |
    |   2 | 李四   |  19 | 男        | 2004-01-01 | 上海    |
    |   3 | 王五   |  20 | 男        | NULL       | 上海    |
    |   4 | 赵六   |  21 | 男        | NULL       | 上海    |
    |   5 | 小明   |   1 | 不知道    | NULL       | 上海    |
    |   6 | 小红   |  18 | 女        | 2005-11-11 | 北京    |
    |   7 | 小蓝   |  17 | 女        | 2006-03-03 | 北京    |
    |   8 | 小绿   |  15 | 女        | NULL       | 北京    |
    |   9 | 小粉   |  18 | 不知道    | 2005-12-12 | 北京    |
    +-----+--------+-----+-----------+------------+---------+
    ```

3. 将小明的年龄修改为 19，性别修改为男，地址修改为广州

    ```sql
    UPDATE student SET age=19,gender='男',address='广州' WHERE name='小明';
    ```

    ```sql
    +-----+--------+-----+-----------+------------+---------+
    | sid | name   | age | gender    | birthday   | address |
    +-----+--------+-----+-----------+------------+---------+
    |   1 | 张三   |  18 | 男        | NULL       | 上海    |
    |   2 | 李四   |  19 | 男        | 2004-01-01 | 上海    |
    |   3 | 王五   |  20 | 男        | NULL       | 上海    |
    |   4 | 赵六   |  21 | 男        | NULL       | 上海    |
    |   5 | 小明   |  19 | 男        | NULL       | 广州    |
    |   6 | 小红   |  18 | 女        | 2005-11-11 | 北京    |
    |   7 | 小蓝   |  17 | 女        | 2006-03-03 | 北京    |
    |   8 | 小绿   |  15 | 女        | NULL       | 北京    |
    |   9 | 小粉   |  18 | 不知道    | 2005-12-12 | 北京    |
    +-----+--------+-----+-----------+------------+---------+
    ```

## 删除数据

`DELETE`语句用于删除数据表中现有的记录。同样的，`DELETE`命令通常和`WHERE`子句一起使用，用以删除满足条件的记录；如果不使用`WHERE`子句，那么表中所有的记录都将被删除。

**基本语法：**

```sql
DELETE FROM <表名> WHERE condition;
```

除此之外，`TRUNCATE`也能删除表中的数据。

```sql
TRUNCATE [TABLE] <表名>;
```

但是它们之间有一些区别。`DELETE`可以带`WHERE`条件，因此支持条件删除，而`TRUNCATE`**只能删除整个表**。

此外，由于`DELETE`是数据操作语言（DML），操作时原数据会被放到 rollback segment 中，可以被回滚；而`TRUNCATE`是数据定义语言（DDL)，它比使用`DELETE`语句删除所有数据更快，因为它不会生成任何撤消日志或写入二进制日志。请注意，`TRUNCATE`语句会永久删除表中的所有数据，因此在使用前应谨慎。

**参考示例：**

1. 删除 sid 为 9 的学生信息

    ```sql
    DELETE FROM student WHERE sid=9;
    SELECT * FROM student;
    ```

    ```sql
    +-----+--------+-----+--------+------------+---------+
    | sid | name   | age | gender | birthday   | address |
    +-----+--------+-----+--------+------------+---------+
    |   1 | 张三   |  18 | 男     | NULL       | 上海    |
    |   2 | 李四   |  19 | 男     | 2004-01-01 | 上海    |
    |   3 | 王五   |  20 | 男     | NULL       | 上海    |
    |   4 | 赵六   |  21 | 男     | NULL       | 上海    |
    |   5 | 小明   |  19 | 男     | NULL       | 广州    |
    |   6 | 小红   |  18 | 男     | 2005-11-11 | 北京    |
    |   7 | 小蓝   |  17 | 男     | 2006-03-03 | 北京    |
    |   8 | 小绿   |  15 | 男     | NULL       | 北京    |
    +-----+--------+-----+--------+------------+---------+
    ```

    请注意 SQL DELETE 语句中的 WHERE 子句！WHERE 子句规定哪条记录或者哪些记录需要删除。如果省略了 WHERE 子句，所有的记录都将被删除！

2. 删除表中所有的信息

    ```sql
    TRUNCATE TABLE student;
    SELECT * FROM student;
    ```

    再次查看表已为空。
